<!DOCTYPE html>
<html lang="en" class="dark">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Contact Us - PureHex Media</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      body {
        font-family: 'Inter', sans-serif;
      }

      .form-input {
        width: 100%;
        padding: 0.75rem 1rem;
        border-radius: 0.5rem;
        background-color: #1f2937;
        color: white;
        border: 1px solid #374151;
      }

      .form-input:focus {
        outline: none;
        border-color: #3b82f6;
      }
    </style>
  </head>

  <body class="bg-gray-900 text-white">
    <header class="py-6 bg-gray-950 shadow-md">
      <div class="max-w-6xl mx-auto px-4">
        <h1 class="text-3xl font-bold text-center text-white">Connect With Us</h1>
      </div>
    </header>

    <main class="py-16 px-4">
      <div class="max-w-3xl mx-auto bg-gray-800 p-8 rounded-lg shadow-md">
        <h2 class="text-2xl font-bold mb-6 text-center">Get in Touch</h2>
        <form id="contact-form">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <label for="name" class="block text-sm font-medium text-gray-300 mb-2">Name</label>
              <input type="text" id="name" name="name" class="form-input" required />
            </div>
            <div>
              <label for="email" class="block text-sm font-medium text-gray-300 mb-2">Email</label>
              <input type="email" id="email" name="email" class="form-input" required />
            </div>
          </div>

          <div class="mt-6">
            <label for="service" class="block text-sm font-medium text-gray-300 mb-2">Service of Interest</label>
            <select id="service" name="service" class="form-input" required>
              <option value="" disabled selected>Select a service...</option>
              <option value="graphic">Graphic Design</option>
              <option value="logo">Logo</option>
              <option value="Instagram">Manage Instagram</option>
              <option value="Festive">Festive Post</option>
              <option value="Other">Other</option>
            </select>
          </div>

          <div class="mt-6">
            <label for="description" class="block text-sm font-medium text-gray-300 mb-2">How can we help?</label>
            <textarea id="description" name="description" rows="4" class="form-input"></textarea>
          </div>

          <div class="mt-8 text-center">
            <button type="submit" id="submit-button" class="bg-gradient-to-r from-blue-500 to-purple-500 hover:from-blue-600 hover:to-purple-600 text-white font-bold px-8 py-3 rounded-full text-base transition-all duration-300 inline-block hover:scale-105 w-full sm:w-auto disabled:opacity-50 disabled:cursor-wait">
              Send Message
            </button>
          </div>
          <p id="form-message" class="text-center mt-4 text-sm"></p>
        </form>
      </div>
    </main>

    <script type="module">
      import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm';

      const supabaseUrl = 'https://xdgrmpzngpfpmzfjqvuv.supabase.co';
      const supabaseKey = 'YOUR_SUPABASE_ANON_KEY'; // replace with your actual anon key
      const supabaseClient = createClient(supabaseUrl, supabaseKey);

      const contactForm = document.getElementById('contact-form');
      const submitButton = document.getElementById('submit-button');
      const formMessage = document.getElementById('form-message');

      contactForm.addEventListener('submit', async (event) => {
        event.preventDefault();

        submitButton.disabled = true;
        submitButton.textContent = 'Sending...';
        formMessage.textContent = '';

        const formData = new FormData(contactForm);
        const name = formData.get('name')?.trim();
        const email = formData.get('email')?.trim();
        const service = formData.get('service');
        const description = formData.get('description')?.trim();

        // Manual required field check
        if (!name || !email || !service) {
          formMessage.textContent = 'Please fill in all required fields.';
          formMessage.style.color = '#ef4444';
          submitButton.disabled = false;
          submitButton.textContent = 'Send Message';
          return;
        }

        try {
          const { data, error } = await supabaseClient
            .from('contacts')
            .insert([{ name, email, service, description }]);

          if (error) throw error;

          window.location.href = 'thank-you.html';
        } catch (error) {
          formMessage.textContent = 'An error occurred. Please try again.';
          formMessage.style.color = '#ef4444';
          console.error('Error submitting form:', error.message);

          submitButton.disabled = false;
          submitButton.textContent = 'Send Message';
        }
      });
    </script>
  </body>
</html>
